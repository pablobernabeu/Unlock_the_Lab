import"./modulepreload-polyfill-B5Qt9EMX.js";import{o as b,G as h,s as w,a as d,b as v,d as a}from"./firebase-config-GGoD4bnV.js";import{r,a as p,g as c}from"./firebase-QsoZ-6oB.js";b(d,e=>{e?(I(),g()):E()});window.loginWithGoogle=async function(){const e=document.getElementById("login-error"),t=new h;try{await w(d,t),e.style.display="none"}catch(n){n.code!=="auth/popup-closed-by-user"&&(e.textContent=`Login failed: ${n.message}`,e.style.display="block")}};window.logoutAdmin=async function(){await v(d)};function E(){document.getElementById("login-section").style.display="block",document.getElementById("admin-panel").style.display="none"}function I(){document.getElementById("login-section").style.display="none",document.getElementById("admin-panel").style.display="block"}async function g(){try{const e=r(a,"active"),t=await c(e),n=t.exists()?Object.keys(t.val()).length:0;document.getElementById("active-count").textContent=n;const i=r(a,"ratings"),l=await c(i);let u=0;if(l.exists()){const m=l.val();Object.values(m).forEach(f=>{u+=Object.keys(f).length})}document.getElementById("total-ratings").textContent=u;const s=r(a,"leaderboard"),o=await c(s),y=o.exists()?Object.keys(o.val()).length:0;document.getElementById("leaderboard-count").textContent=y}catch(e){console.error("Error loading stats:",e)}}window.stopAllSessions=async function(){if(!confirm("Are you sure you want to stop all active sessions? This will force all participants to start new sessions."))return;const e=document.getElementById("action-result");e.innerHTML='<p style="color: #f59e0b;">⏳ Stopping all sessions...</p>';try{const t=r(a,"active");await p(t),e.innerHTML='<p style="color: #10b981; padding: 1rem; background: #d1fae5; border-radius: 4px;">✅ All active sessions have been stopped successfully.</p>',await g()}catch(t){e.innerHTML=`<p style="color: #ef4444; padding: 1rem; background: #fef2f2; border-radius: 4px;">❌ Error: ${t.message}</p>`}};window.deleteAllRatings=async function(){const e=r(a,"ratings"),t=await c(e);if(!t.exists()){alert("ℹ️ No ratings data to delete.");return}const n=t.val();let i=0;Object.values(n).forEach(o=>{i+=Object.keys(o).length});const l=`⚠️ WARNING: You are about to permanently delete ${i} rating(s) across all studies.

This action CANNOT be undone!

Type "DELETE" to confirm:`;if(prompt(l)!=="DELETE"){alert("❌ Deletion cancelled.");return}const s=document.getElementById("delete-result");s.innerHTML='<p style="color: #f59e0b;">⏳ Deleting all ratings data...</p>';try{await p(e),s.innerHTML='<p style="color: #10b981; padding: 1rem; background: #d1fae5; border-radius: 4px;">✅ All ratings data has been permanently deleted.</p>',await g()}catch(o){s.innerHTML=`<p style="color: #ef4444; padding: 1rem; background: #fef2f2; border-radius: 4px;">❌ Error: ${o.message}</p>`}};window.auth=d;window.database=a;
